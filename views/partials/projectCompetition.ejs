<%
function getSrcUrl(item) {
  // Get the github info and url fallback
  var github = item.github,
      srcUrl = item.srcUrl;

  // If there is a srcUrl, return now
  if (srcUrl !== undefined) {
    return srcUrl;
  }

  // Fallback srcUrl to url
  srcUrl = item.url;

  // If there is a github repo, use that
  if (github !== undefined) {
    // If the item is a gist, return it as such
    var isGist = github.indexOf('gist') > -1;
    if (isGist) {
      srcUrl = 'https://gist.github.com/' + github.slice(5);
    } else {
    // Otherwise, go with the normal github flow
      srcUrl = 'https://github.com/' + github;
    }
  }

  return srcUrl;
}

var srcUrl = getSrcUrl(item),
    mdn = item.mdn,
    pageUrl = item.url;

// If the pageUrl is not defined
if (pageUrl === undefined) {
  // and mdn is defined, use that
  if (mdn !== undefined) {
    pageUrl = 'https://developer.mozilla.org/en-US/demos/detail/' + mdn;
  } else {
  // Otherwise, fallback to the srcUrl
    pageUrl = srcUrl;
  }
}

var type = item.type,
    isCssOff = type === 'cssOff',
    headerWidth = isCssOff ? "l_span2" : "l_span4";
%>
<div class="l_span6">
  <div class="l_row l_rowNested superComfyText">
    <div class="<%=headerWidth%>">
      <a href="<%=pageUrl%>" target="_blank"><h3 class="headerKilo superComfyText"><%=item.name%></h3></a>
    </div>
    <% if (isCssOff) { %>
      <div class="l_span4 layoutFlipped">
        <img src="public/images/barLines.png" alt="Score" style="height: 20px; vertical-align: middle; margin-top: -5px; margin-right: 15px;" /><span class="score"><%=item.score%></span>
      </div>
    <% } else { %>
      <div class="l_span1 layoutFlipped" style="overflow: visible; white-space: nowrap; position:relative;">
        <div style="position: absolute; right: 0;">
          <img src="public/images/eye.png" alt="Views" style="height: 14px; vertical-align: middle; margin-top: -3px; margin-right: 10px;"/><span class="viewCount"><%=item.views%></span>
        </div>
      &nbsp;
      </div>
      <div class="l_span1 layoutFlipped">
        <img src="public/images/heart.png" alt="Likes" style="height: 18px; vertical-align: middle; margin-top: -4px; margin-right: 10px;" /><span class="likeCount"><%=item.likes%></span>
      </div>
    <% } %>
  </div>
  <div class="l_row l_rowNested">
    <div class="l_span4">
      <%=item.competition%>
    </div>
    <div class="l_span2 layoutFlipped">
      <% if (isCssOff) { %>
        <img src="public/images/ribbon.png" alt="Rank" style="height: 30px; vertical-align: middle; margin-top: -5px; margin-right: 7px;" /><span class="rank"><%=item.rank%></span>
      <% } else if (item.award) { %>
        <img src="public/images/ribbon.png" alt="Award" style="height: 30px; vertical-align: middle; margin-top: -5px; margin-right: 7px;" /><span class="award"><%=item.award%></span>
      <% } %>
    </div>
  </div>
</div>